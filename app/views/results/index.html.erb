<p id="notice">
    <%= notice %>
</p>
<h1 style="text-align:center; color:green">Rezultate</h1>
<%= form_tag results_path, method: :get, id: 'results_search_form' do %>
<%= label_tag "runner_id", "Sportiv", class: "label-filter" %>
<%= select_tag :runner_id, options_for_select(Runner.order("runner_name", "surname").map { |runner| ["#{runner.runner_name} #{runner.surname}", runner.id] }, params[:runner_id]), include_blank: "Toti Sportivi", class: "custom-select" %>
<br>
<%= label_tag "competition_id", "Competitia", class: "label-filter" %>
<%= select_tag :competition_id, options_for_select(Competition.all.map { |comp| ["#{comp.competition_name} #{comp.date.year} #{comp.distance_type}", comp.id] }, params[:competition_id]), include_blank: "Toate Competitiile", class: "custom-select" %>
<br>
<%= label_tag "category_id", "Categoria indeplinita", class: "label-filter" %>
<%= select_tag :category_id, options_for_select(Category.pluck(:category_name, :id), params[:category_id]), include_blank: "Toate Categoriile", class: "custom-select" %>
<br>
<%= label_tag "wre", "Doar Rezultate WRE",class: "label-filter" %>
<%= check_box_tag :wre, 1, params[:wre], id: "wre" %>
<br>
<%= label_tag "date_from", "Data: De la", class: "label-filter" %>
<%= text_field_tag :date_from, params[:date_from] , id: 'date_from', placeholder: "zz/ll/aaaa", class: "datepicker custom-select" %>
<%= label_tag "date_to", "Pina la" %>
<%= text_field_tag :date_to, params[:date_to], id: 'date_to', placeholder: "zz/ll/aaaa", class: "datepicker custom-select" %>
<br>
<%= submit_tag "Filtreaza", class: "btn btn-info" %>
<% end %>
<hr>
<table class="table table-striped table-bordered table-hover">
    <thead class="table-primary">
        <tr>
            <th scope="col" class="sortable" data-sort-by="place">
                <%= link_to 'Locul' %>
            </th>
            <th class="sortable" data-sort-by="runner_name">
                <%= link_to 'Sportiv'%>
            </th>
            <th class="sortable" data-sort-by="time">
                <%= link_to 'Timpul' %>
            </th>
            <th class="sortable" data-sort-by="category_id">
                <%= link_to 'Categoria indeplinita' %>
            </th>
            <th class="sortable" data-sort-by="date">
                <%= link_to 'Data' %>
            </th>
            <th class="sortable" data-sort-by="competition_name">
                <%= link_to 'Competitia' %>
            </th>
            <th class="sortable" data-sort-by="group_name">
                <%= link_to 'Grupa' %>
            </th>
            <th class="sortable" data-sort-by="wre_points">
                <%= link_to 'Wre Puncte' %>
            </th>
            <th colspan="3">Acțiuni</th>
        </tr>
    </thead>
    <tbody>
        <% @results.each do |result| %>
        <tr>
            <td>
                <%= result.place %>
            </td>
            <td>
                <%= link_to "#{result.runner.runner_name} #{result.runner.surname}", result.runner  %>
            </td>
            <td>
                <%= Time.at(result.time).utc.strftime('%H:%M:%S') %>
            </td>
            <td>
                <%= result.category.category_name %>
            </td>
            <td>
                <%= result.date %>
            </td>
            <td>
                <%= link_to "#{result.group.competition.competition_name} #{result.group.competition.date.year}", result.group.competition %>
            </td>
            <td>
                <%= link_to result.group.group_name, result.group %>
            </td>
            <td>
                <%= result.wre_points %>
            </td>
            <td>
                <div class="btn-group" role="group" aria-label="Basic example">
                    <%= link_to 'Arată', result, class: "btn btn-warning btn-sm"%>
                    <% if admin_user? %>
                    <%= link_to 'Editează', edit_polymorphic_path(result), class: "btn btn-success btn-sm"%>
                    <%= link_to 'Șterge', result, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger btn-sm" %>
                    <% end %>
                </div>
            </td>
        </tr>
        <% end %>
    </tbody>
    <div class="pagination">
        <%= will_paginate @runners, renderer: WillPaginate::ActionView::BootstrapLinkRenderer %>
    </div>
</table>
<br>
<% if admin_user? || club_admin? %>
<%= link_to 'Rezultat Nou', new_result_path, class: "btn btn-info" %>
<% end %>
